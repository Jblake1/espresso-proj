import{t as P,a as D,d as Oe}from"../chunks/DLZ7H7Fm.js";import"../chunks/BMgznbf7.js";import{G as Ae,T as Be,N as Ce,U as De,V as r,X as t,W as v,g as e,R as d,Z as n,_ as q,aw as Le,a4 as Fe,Q as qe}from"../chunks/BOw1AeM4.js";import{l as Re,d as Me,s as g,e as Ie}from"../chunks/BReulVDI.js";import{b as Ve,a as Xe,p as c,i as I,s as Ze,c as Ue}from"../chunks/Db0Jo1o8.js";import{e as Te,i as Ne}from"../chunks/CZS3sv3T.js";import{s as Se,a as He,r as Qe,A as We}from"../chunks/DJnrMVhu.js";import{b as Ke}from"../chunks/QFNNfdoR.js";import{b as Ye}from"../chunks/Dn1lnk-c.js";import{o as ze}from"../chunks/BMBHoIzy.js";function Je(s,i,u){if(s.multiple)return er(s,i);for(var _ of s.options){var m=me(_);if(Ve(m,i)){_.selected=!0;return}}(!u||i!==void 0)&&(s.selectedIndex=-1)}function $e(s,i){Ae(()=>{var u=new MutationObserver(()=>{var _=s.__value;Je(s,_)});return u.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{u.disconnect()}})}function Ee(s,i,u=i){var _=!0;Re(s,"change",m=>{var b=m?"[selected]":":checked",x;if(s.multiple)x=[].map.call(s.querySelectorAll(b),me);else{var A=s.querySelector(b)??s.querySelector("option:not([disabled])");x=A&&me(A)}u(x)}),Ae(()=>{var m=i();if(Je(s,m,_),_&&m===void 0){var b=s.querySelector(":checked");b!==null&&(m=me(b),u(m))}s.__value=m,_=!1}),$e(s)}function er(s,i){for(var u of s.options)u.selected=~i.indexOf(me(u))}function me(s){return"__value"in s?s.__value:s.value}function Ge(s){if(s&&typeof s.select=="function"){const i=()=>s.select();return s.addEventListener("focus",i),{destroy:()=>s.removeEventListener("focus",i)}}}function rr(s,i){Be(i,!0);let u=Xe(i,"value",15);const _=async()=>{try{const m=await fetch("/saveSetup",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({drink:i.props.drink,brewingDevice:i.props.brewingDevice,grinder:i.props.grinder,grindSetting:i.props.grindSetting,coffeeBeans:i.props.coffeeBeans})});if(m.ok)alert("Setup saved successfully!"),u(u()==="1"?"0":"1");else{const b=await m.json();alert("Failed to save setup: "+b.message)}}catch(m){console.error("Error saving setup:",m),alert("An error occurred while saving the setup.")}};Ce(()=>{i.props&&i.props.drink&&i.props.brewingDevice&&i.props.grinder&&i.props.grindSetting&&i.props.coffeeBeans&&_()}),De()}var tr=(s,i)=>i(),ar=P('<div><button type="button" class="btn btn-sm variant-filled">Add to Notes</button></div>');function ke(s,i){Be(i,!0);const u=async()=>{try{const b=await fetch("/archiveSetup",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({drink:i.drink.drink,brewingDevice:i.drink.brewingDevice,grinder:i.drink.grinder,grindSetting:i.drink.grindSetting,coffeeBeans:i.drink.coffeeBeans})});if(b.ok)alert("Setup archived successfully!");else{const x=await b.json();alert("Failed to archive setup: "+x.message)}}catch(b){console.error("Error archiving setup:",b),alert("An error occurred while archiving the setup.")}};var _=ar(),m=r(_);m.__click=[tr,u],t(_),D(s,_),De()}Me(["click"]);var ir=P('<div class="setup svelte-1jiuw5u"><div class="card svelte-1jiuw5u"><header class="card-header py-5 px-3 bg-cover bg-center svelte-1jiuw5u"><div class="font-medium text-white drop-shadow-md bg-primary-500/80 rounded px-2 py-1 w-auto inline-block"><span class="truncate inline-block max-w-[150px] align-middle"> </span> <span class="align-middle"> </span></div></header> <section class="py-1 px-3"> </section> <section class="py-1 px-3"> </section> <div class="flex flex-row items-center justify-between py-2 px-3 cardfooter"><footer class="card-footer py-2"> </footer> <div class="ArchiveButton"><!></div></div></div></div>'),nr=P('<div class="setup svelte-1jiuw5u"><div class="card svelte-1jiuw5u"><header class="card-header py-5 px-3 bg-cover bg-center svelte-1jiuw5u"><div class="font-medium text-white drop-shadow-md bg-primary-500/80 rounded px-2 py-1 w-auto inline-block"><span class="truncate inline-block max-w-[150px] align-middle"> </span> <span class="align-middle"> </span></div></header> <section class="py-1 px-3"> </section> <section class="py-1 px-3"> </section> <div class="flex flex-row items-center justify-between py-2 px-3 cardfooter"><footer class="card-footer py-2"> </footer> <div class="ArchiveButton"><!></div></div></div></div>'),sr=P('<div class="setup svelte-1jiuw5u"><div class="card svelte-1jiuw5u"><header class="card-header py-5 px-3 bg-cover bg-center svelte-1jiuw5u"><div class="font-medium text-white drop-shadow-md bg-primary-500/80 rounded px-2 py-1 w-auto inline-block"><span class="truncate inline-block max-w-[150px] align-middle"> </span> <span class="align-middle"> </span></div></header> <section class="py-1 px-3"> </section> <section class="py-1 px-3"> </section> <div class="flex flex-row items-center justify-between py-2 px-3 cardfooter"><footer class="card-footer py-2"> </footer> <div class="ArchiveButton"><!></div></div></div></div>'),or=P('<div class="setup svelte-1jiuw5u"><div class="card svelte-1jiuw5u"><header class="card-header py-5 px-3 bg-cover bg-center svelte-1jiuw5u"><div class="font-medium text-white drop-shadow-md bg-primary-500/80 rounded px-2 py-1 w-auto inline-block"><span class="truncate inline-block max-w-[150px] align-middle"> </span> <span class="align-middle"> </span></div></header> <section class="py-1 px-3"> </section> <section class="py-1 px-3"> </section> <div class="flex flex-row items-center justify-between py-2 px-3 cardfooter"><footer class="card-footer py-2"> </footer> <div class="ArchiveButton"><!></div></div></div></div>'),lr=P('<div class="flex flex-col w-full items-start p-2"><div class="flex flex-col sm:flex-row w-full items-start gap-4 mb-4"><!> <!></div> <div class="flex flex-col sm:flex-row w-full items-start p-2.5 gap-4 mb-4"><!> <!></div></div>');function dr(s,i){Be(i,!0);let u="/images/espresso1.jpg",_=v(""),m=v(""),b=v(""),x=v(""),A=v(""),V=v(""),Y=v(""),C=v(""),$=v(""),X=v(""),E=v(""),R=v(""),ee=v(""),oe=v(""),le=v(""),re=v(""),de=v(""),ve=v(""),ce=v(""),Z=v(""),Pe=()=>({drink:e(_),grinder:e(m),grindSetting:e(b),coffeeBeans:e(x),brewingDevice:e(A)}),be=()=>({drink:e(V),grinder:e(Y),grindSetting:e(C),coffeeBeans:e($),brewingDevice:e(X)}),xe=()=>({drink:e(E),grinder:e(R),grindSetting:e(ee),coffeeBeans:e(oe),brewingDevice:e(le)}),he=()=>({drink:e(re),grinder:e(de),grindSetting:e(ve),coffeeBeans:e(ce),brewingDevice:e(Z)}),te=v(c({})),ae=v(c({})),ue=v(c({})),U=v(c({}));const ie=async()=>{try{const f=await fetch("/getSetup",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(f.ok){const h=await f.json();console.log("Recent setups:",h);const o=h.setups;console.log("Setups:",o),o.length>0&&(n(_,c(o[0].drink)),n(m,c(o[0].grinder)),n(b,c(o[0].grindSetting)),n(x,c(o[0].coffeeBeans)),n(A,c(o[0].brewingDevice)),n(te,c(Pe()))),o.length>1&&(n(V,c(o[1].drink)),n(Y,c(o[1].grinder)),n(C,c(o[1].grindSetting)),n($,c(o[1].coffeeBeans)),n(X,c(o[1].brewingDevice)),n(ae,c(be()))),o.length>2&&(n(E,c(o[2].drink)),n(R,c(o[2].grinder)),n(ee,c(o[2].grindSetting)),n(oe,c(o[2].coffeeBeans)),n(le,c(o[2].brewingDevice)),n(ue,c(xe()))),o.length>3&&(n(re,c(o[3].drink)),n(de,c(o[3].grinder)),n(ve,c(o[3].grindSetting)),n(ce,c(o[3].coffeeBeans)),n(Z,c(o[3].brewingDevice)),n(U,c(he())))}else{const h=await f.json();console.error("Failed to fetch recent setups:",h.message)}}catch(f){console.error("Error fetching recent setups:",f)}};ze(()=>{ie()}),Ce(()=>{i.trigger&&ie()});var ne=lr(),H=r(ne),Q=r(H);{var fe=f=>{var h=ir(),o=r(h),p=r(o);Se(p,"style",`background-image: url('${u}');`);var j=r(p),S=r(j),O=r(S,!0);t(S);var G=d(S,2),F=r(G);t(G),t(j),t(p);var w=d(p,2),T=r(w);t(w);var y=d(w,2),N=r(y);t(y);var z=d(y,2),k=r(z),M=r(k);t(k);var a=d(k,2),l=r(a);ke(l,{get drink(){return e(te)}}),t(a),t(z),t(o),t(h),q(()=>{g(O,e(x)),g(F,`| ${e(_)??""}`),g(T,`Brewing Device: ${e(A)??""}`),g(N,`Grinder: ${e(m)??""}`),g(M,`Grind Setting: ${e(b)??""}`)}),D(f,h)};I(Q,f=>{e(_)!==""&&f(fe)})}var pe=d(Q,2);{var we=f=>{var h=nr(),o=r(h),p=r(o);Se(p,"style",`background-image: url('${u}');`);var j=r(p),S=r(j),O=r(S,!0);t(S);var G=d(S,2),F=r(G);t(G),t(j),t(p);var w=d(p,2),T=r(w);t(w);var y=d(w,2),N=r(y);t(y);var z=d(y,2),k=r(z),M=r(k);t(k);var a=d(k,2),l=r(a);ke(l,{get drink(){return e(ae)}}),t(a),t(z),t(o),t(h),q(()=>{g(O,e($)),g(F,`| ${e(V)??""}`),g(T,`Brewing Device: ${e(X)??""}`),g(N,`Grinder: ${e(Y)??""}`),g(M,`Grind Setting: ${e(C)??""}`)}),D(f,h)};I(pe,f=>{e(V)!==""&&f(we)})}t(H);var W=d(H,2),se=r(W);{var je=f=>{var h=sr(),o=r(h),p=r(o);Se(p,"style",`background-image: url('${u}');`);var j=r(p),S=r(j),O=r(S,!0);t(S);var G=d(S,2),F=r(G);t(G),t(j),t(p);var w=d(p,2),T=r(w);t(w);var y=d(w,2),N=r(y);t(y);var z=d(y,2),k=r(z),M=r(k);t(k);var a=d(k,2),l=r(a);ke(l,{get drink(){return e(ue)}}),t(a),t(z),t(o),t(h),q(()=>{g(O,e(oe)),g(F,`| ${e(E)??""}`),g(T,`Brewing Device: ${e(le)??""}`),g(N,`Grinder: ${e(R)??""}`),g(M,`Grind Setting: ${e(ee)??""}`)}),D(f,h)};I(se,f=>{e(E)!==""&&f(je)})}var ye=d(se,2);{var K=f=>{var h=or(),o=r(h),p=r(o);Se(p,"style",`background-image: url('${u}');`);var j=r(p),S=r(j),O=r(S,!0);t(S);var G=d(S,2),F=r(G);t(G),t(j),t(p);var w=d(p,2),T=r(w);t(w);var y=d(w,2),N=r(y);t(y);var z=d(y,2),k=r(z),M=r(k);t(k);var a=d(k,2),l=r(a);ke(l,{get drink(){return e(U)}}),t(a),t(z),t(o),t(h),q(()=>{g(O,e(ce)),g(F,`| ${e(re)??""}`),g(T,`Brewing Device: ${e(Z)??""}`),g(N,`Grinder: ${e(de)??""}`),g(M,`Grind Setting: ${e(ve)??""}`)}),D(f,h)};I(ye,f=>{e(re)!==""&&f(K)})}t(W),t(ne),D(s,ne),De()}var vr=P("<option> </option>"),cr=P("<option> </option>"),ur=P('<button type="button" class="btn variant-filled"><!></button>'),fr=P("<div></div>"),pr=P('<div class="text-red-500 mb-4 p-2 bg-red-100 border border-red-300 rounded"> </div>'),gr=P('<div class="RecentSetups svelte-lbz1xu"><!></div>'),_r=P('<div class="w-full text-center p-10 border border-primary-200 rounded-lg bg-tertiary-900/50"><p class="text-xl font-semibold text-tertiary-200">Not Logged In</p> <p class="mt-2 text-tertiary-400">No coffee records can be displayed</p> <a href="/login" class="btn variant-filled-primary mt-6">Login to view</a></div>'),mr=P('<div class="flex flex-col items-start gap-4 p-4 md:flex-row md:gap-6 md:p-6"><div class="flex flex-col items-start gap-4"><div class="toDoForm svelte-lbz1xu"><form class="border rounded-lg"><div class="flex justify-center w-full"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col items-start gap-4 px-4"><h2 class="label-wrapper min-w-40 min-h-6 svelte-lbz1xu"><label for="drink" class="label__lg font-semibold">Drink</label></h2> <select id="drink" class="select w-full px-3 py-2 border rounded min-h-10 min-w-30"><option>Select a drink</option><option>Espresso</option><option>Coffee</option></select> <h2 class="label-wrapper min-w-40 min-h-6 svelte-lbz1xu"><label for="brewing_device" class="label__lg font-semibold">Brewing Device</label></h2> <select id="brewingDevice" class="select w-full px-3 py-2 border rounded min-w-30 min-h-10"><option>Select a device</option><!></select></div> <div class="flex flex-col items-start gap-4 px-4"><h2 class="label-wrapper min-w-40 min-h-6 svelte-lbz1xu"><label for="grinder" class="label__lg font-semibold">Grinder</label></h2> <select id="grinder" class="select w-full px-3 py-2 border rounded min-w-30 min-h-10"><option>Select a grinder</option><!></select> <h2 class="label-wrapper min-w-40 min-h-6 svelte-lbz1xu"><label for="coffeeBeans" class="label__lg font-semibold">Bean</label></h2> <div class="relative w-full"><input type="text" id="coffeeBeans" autoComplete="off" class="input input__lg min-w-30 min-h-10 svelte-lbz1xu" maxlength="40" placeholder="Enter coffee bean"> <div class="text-xs text-gray-500 absolute right-2 bottom-6"> </div></div></div></div></div> <!></form> <!> <div class="CoffeeSetupSave svelte-lbz1xu"><!></div></div></div> <!></div>');function br(s,i){Be(i,!0);const[u,_]=Ze(),m=()=>Ue(ee,"$userStore",u);let b=v(""),x=v(""),A=v(""),V=v(""),Y=v(""),C=v(""),$=v(""),X=v(c({})),E=v(""),R=v(!1);const ee=Le(null);let oe=["Espresso Machine","AeroPress","Moka Pot","Lever Machine"],le=["Pour Over","French Press","Drip Machine","Cold Brew"],re=["DF 54","DF 64","Baratza Encore","Baratza Encore ESP","Baratza Virtuoso","Breville Smart Grinder Pro","1Zpresso JX Pro"],de=["DF 54","DF 64","Baratza Encore","Baratza Encore ESP","Baratza Sette 270","Baratza Virtuoso","Breville Smart Grinder Pro","Eureka Mignon Specialita","1Zpresso JX Pro"],ve=Fe(()=>e(x)==="Espresso"?oe:e(x)==="Coffee"?le:[]),ce=Fe(()=>e(x)==="Espresso"?de:e(x)==="Coffee"?re:[]);Ce(()=>{e(x)&&n(b,"")});let Z=v(""),Pe=()=>({drink:e(x),brewingDevice:e(b),coffeeBeans:e(C),grinder:e(A),grindSetting:e(V)}),be,xe;const he=async()=>{if(n(E,""),!e(x)){n(E,"Please select a drink type");return}if(!e(b)){n(E,"Please select a brewing device");return}if(!e(A)){n(E,"Please select a grinder");return}if(!e(C)||e(C).trim()===""){n(E,"Please enter coffee bean information");return}n(R,!0);try{const a=await fetch("/recommendation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brewing_device:e(b),drink:e(x),grinder:e(A),coffee_beans:e(C)})});if(a.ok){const l=await a.json();console.log("Received data:",l);const B=l.advice;console.log("Advice:",B),n(V,c(B.grind_recommendation)),n(Y,c(B.bean_segmentation)),console.log("Grind Segment:",e(Y)),n($,c(B.bean_analysis)),console.log("Bean Description:",e($)),n(X,c(Pe()))}else throw new Error("Network response was not ok")}catch(a){console.error("There was a problem with the fetch operation:",a),n(E,"Error submitting data. Please try again.")}finally{n(R,!1)}};ze(()=>i.autofocus&&be.focus&&be.focus()),ze(()=>{const a=localStorage.getItem("user");if(a)try{ee.set(JSON.parse(a))}catch(l){console.error("Error parsing localStorage user data:",l)}});var te=mr(),ae=r(te),ue=r(ae),U=r(ue),ie=r(U),ne=r(ie),H=r(ne),Q=d(r(H),2),fe=r(Q);fe.value=((fe.__value="")==null,"");var pe=d(fe);pe.value=(pe.__value="Espresso")==null?"":"Espresso";var we=d(pe);we.value=(we.__value="Coffee")==null?"":"Coffee",t(Q);var W=d(Q,4),se=r(W);se.value=((se.__value="")==null,"");var je=d(se);Te(je,17,()=>e(ve),Ne,(a,l)=>{var B=vr(),ge={},J=r(B,!0);t(B),q(()=>{ge!==(ge=e(l))&&(B.value=(B.__value=e(l))==null?"":e(l)),g(J,e(l))}),D(a,B)}),t(W),t(H);var ye=d(H,2),K=d(r(ye),2),f=r(K);f.value=((f.__value="")==null,"");var h=d(f);Te(h,17,()=>e(ce),Ne,(a,l,B,ge)=>{var J=cr(),L={},_e=r(J,!0);t(J),q(()=>{L!==(L=e(l))&&(J.value=(J.__value=e(l))==null?"":e(l)),g(_e,e(l))}),D(a,J)}),t(K);var o=d(K,4),p=r(o);Qe(p),Ae(()=>Ke(p,()=>e(C),a=>n(C,a))),Ye(p,a=>xe=a,()=>xe),He(p,a=>Ge==null?void 0:Ge(a));var j=d(p,2),S=r(j);t(j),t(o),t(ye),t(ne),t(ie);var O=d(ie,2);{var G=a=>{var l=ur();l.__click=he;var B=r(l);{var ge=L=>{var _e=Oe("Submitting...");D(L,_e)},J=L=>{var _e=Oe("Submit");D(L,_e)};I(B,L=>{e(R)?L(ge):L(J,!1)})}t(l),q(()=>l.disabled=e(R)),D(a,l)},F=a=>{var l=fr();D(a,l)};I(O,a=>{m()?a(G):a(F,!1)})}t(U);var w=d(U,2);{var T=a=>{var l=pr(),B=r(l,!0);t(l),q(()=>g(B,e(E))),D(a,l)};I(w,a=>{e(E)&&a(T)})}var y=d(w,2),N=r(y);rr(N,{get props(){return e(X)},get value(){return e(Z)},set value(a){n(Z,c(a))}}),t(y),t(ue),t(ae);var z=d(ae,2);{var k=a=>{var l=gr(),B=r(l);dr(B,{get props(){return e(X)},get trigger(){return e(Z)}}),t(l),D(a,l)},M=a=>{var l=_r();D(a,l)};I(z,a=>{m()?a(k):a(M,!1)})}t(te),q(()=>{W.disabled=!e(x),K.disabled=!e(x),g(S,`${e(C).length??""}/40`)}),Ie("submit",U,he),Ee(Q,()=>e(x),a=>n(x,a)),Ee(W,()=>e(b),a=>n(b,a)),Ee(K,()=>e(A),a=>n(A,a)),D(s,te),De(),_()}Me(["click"]);var xr=P("<!> <!>",1);function Gr(s){var i=xr(),u=qe(i);We(u,{});var _=d(u,2);br(_,{}),D(s,i)}export{Gr as component};
